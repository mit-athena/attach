#ifdef _AUX_SOURCE
XSRCS = emul_re.c
XOBJS = emul_re.o
XLIBS = -lPW -lc
#endif

#if !defined(ultrix)
RPCLIB=-lrpcsvc
#endif

LIBS = -lhesiod -lkrb -ldes $(RPCLIB) -lzephyr -lcom_err $(XLIBS)

SRCS = main.c util.c attachtab.c attach.c detach.c mul.c nfs.c rvd.c\
	afs.c ufs.c rpc.c mount.c unmount.c zephyr.c getrealm.c\
	rvdutil.c pathcan.c config.c strtok.c $(XSRCS)
OBJS = 	main.o util.o attachtab.o attach.o detach.o mul.o nfs.o rvd.o\
	afs.o ufs.o rpc.o mount.o unmount.o zephyr.o getrealm.o\
	rvdutil.o pathcan.o config.o strtok.o $(XOBJS)


build_program(attach,$(OBJS),,$(LIBS))
install_program(attach,-m 4755 -o root,$(ATHRBINDIR))

install_man(attach.1,attach.1)
install_man(detach.1,detach.1)
install_man(fsid.1,fsid.1)
install_man(attach.conf.5,attach.conf.5)
install_man(attachtab.5,attachtab.5)
install_man(zinit.8,zinit.8)

install_man_links(fsid.1,nfsid.1)

install::
	$(RM) $(DESTDIR)$(ATHRBINDIR)/detach
	$(RM) $(DESTDIR)$(ATHRBINDIR)/fsid
	$(RM) $(DESTDIR)$(ATHRBINDIR)/nfsid
	$(RM) $(DESTDIR)$(ATHRETCDIR)/zinit
	ln -s attach $(DESTDIR)$(ATHRBINDIR)/detach
	ln -s attach $(DESTDIR)$(ATHRBINDIR)/fsid
	ln -s attach $(DESTDIR)$(ATHRBINDIR)/nfsid
	ln -s $(ATHRBINDIR)/attach $(DESTDIR)$(ATHRETCDIR)/zinit
